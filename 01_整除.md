## 整除的概念

&emsp;&emsp;整除就是把小学中的概念描述得更高大上了一些，下面是它的定义（我们用集合 $\mathbb{Z}$ 表示全体整数组成的集合， $\mathbb{N}$ 表示全体自然数组成的集合）。

&emsp;&emsp;**定义**：设 $a,b\in\mathbb{Z}$ ，如果存在 $q\in\mathbb{Z}$ ，使得 $b=aq$ ，那么就说 $b$ 可以被 $a$ 整除或者 $a$ 整除 $b$ ，记作 $a|b$ ，称 $b$ 是 $a$ 的倍数， $a$ 是 $b$ 的因子（也叫做约数，除数）。否则就说 $b$ 不能被 $a$ 整除或者 $a$ 不整除 $b$ ，记作 $a\nmid b$ 。

&emsp;&emsp;由整除的定义，我们可以立即得出整除的一些性质（设 $a,b,c\in\mathbb{Z}$）：
- $a|b\Leftrightarrow -a|b\Leftrightarrow a|-b\Leftrightarrow |a|||b|$
- $a|b$ 且 $b|c\Rightarrow a|c$
- $a|b$ 且 $a|c\Leftrightarrow$ 对任意的 $x,y\in\mathbb{Z}$ 有 $a|bx+cy$
- 若 $m\in\mathbb{Z}$ 且 $m\neq0$ ，则 $a|b\Leftrightarrow ma|mb$
- $a|b$ 且 $b|a\Rightarrow a=\pm b$
- 若 $b\neq 0$ ，则 $a|b\Leftarrow |a|\leqslant |b|$  
只需定义即可证明，此处略过。但是需要注意的是，尽管这些性质十分简单，但是确实十分重要的，我们下面来举例说明。

&emsp;&emsp;**例**：**证明**：若 $3|n$ 且 $7|n$ ，则 $21|n$ 

&emsp;&emsp;**证**：由 $3|n$ 知 $n=3m$ ，所以 $7|3m$ ，又因为 $7|7m$ 得 $7|(7m-2\cdot3m)$ 也就是 $7|m$ ，所以 $21|n$ 。

&emsp;&emsp;**例**：设 $a,b$ 是两个给定的非零整数，且有整数 $x,y$ ，使得 $ax+by=1$ **证明**：(i)若 $a|n$ 且 $b|n$ ，则 $ab|n$ 。(ii)若 $a|bn$ ，则 $a|n$ 。

&emsp;&emsp;**证**：由 $ax+by=1$ ，可得 $n=axn+byn=(na)x+(nb)y$ ，又因为 $a|n$ 且 $b|n$ ，所以 $ab|nb$ 且 $ab|na$ ，故 $ab|(na)x+(nb)y$ ，也就是 $ab|n$ 。这就证明了(i)，因为 $a|bn$ 并且 $a|an$ ，所以 $ab|(na)x+(nb)y$ ，也就是 $ab|n$ ，这就证明了(ii)。

&emsp;&emsp;显然地， $\pm1,\pm b$ 是 $b$ 的因子，我们称其为 $b$ 的**显然因子**，其他因子则称为 $b$ 的**非显然因子**，又叫**真因子**。

> 对于约数（因子），我们有这样一个比较显然的定理：设整数 $b\neq0$ ， $d_1,d_2,...,d_k$ 是它的全体约数，那么 $b/d_1,b/d_2,...,b/d_k$ 也是它的全体约数，也就是说，当 $d$ 遍历 $b$ 的全体约数时， $b/d$ 也遍历 $b$ 的全体约数。

&emsp;&emsp;我们由此可得到下面关于**素数**定义。

&emsp;&emsp;**定义**：设整数 $p\neq0,\pm1$ 。如果 $p$ 除了显然因子外没有其他的因子，那么就称 $p$ 为**素元**，也叫**素数**，若整数 $a\neq0,\pm1$ 并且 $a$ 除了显然因子之外还有真因子，则称 $a$ 为**合数**。

> 一般情况下，素数我们只取正的。

&emsp;&emsp;下面我们来介绍几个关于素数的定理，都比较重要。

&emsp;&emsp;**定理**：若 $a$ 为合数，则 $a$ 的最小真因子为素数，特别地，任何不等于1的正整数都有素因子。

&emsp;&emsp;**证明**：设 $d$ 为 $a$ 的最小真因子，假设 $d$ 不为素数，则 $d$ 也必有真因子 $d'$ ，使得 $d'|d$ ，由整除的性质可知 $d'|a$ ，与 $d$ 为 $a$ 的最小真因子矛盾，故假设错误，原定理成立。

&emsp;&emsp;**定理**：素数有无穷多个。

&emsp;&emsp;**证明一**：假设只有有限个素数，设为 $p_1,P_2,\cdot\cdot\cdot,p_k$ ，考虑 $a=p_1p_2\cdot\cdot\cdot p_k+1$ ，由于素数有限个，那么 $a$ 必然是合数，则 $a$ 的最小真因子必然是素数，记为 $p$ ，而且该素数必等于某一个 $p_i$ ，所以说就有 $p|p_1p_2\cdot\cdot\cdot p_k$ ，又因为 $p|a$ ，所以就有 $p|(a-p_1p_2\cdot\cdot\cdot p_k)$ 也就是 $p|1$ ，这与 $p$ 是素数是矛盾的，故假设错误，原定理成立。

> 若令 $Q_k=q_1q_2\cdot\cdot\cdot q_k+1$ ，我们可以直接计算出一些结果： $Q_1$ =3， $Q_2$ =7， $Q_3$ =31， $Q_4$ =211， $Q_5$ =2311， $Q_6$ = $59\times509$ ， $Q_7$ = $19\times97\times277$ ， $Q_8$ = $347\times27953$ ， $Q_9$ = $317\times703763$ ， $Q_{10}$ = $331\times571\times34231$ ，这里前五个是素数，后五个是合数，所以对于任意的 $k$ ，我们不敢贸然判断 $Q_k$ 是质数还是合数，而且，至今我们都不知道是否有无穷多个 $k$ 使得 $Q_k$ 是质数，也不知道是否有无穷多个 $k$ 使得 $Q_k$ 是合数。

&emsp;&emsp;**证明二**：我们要证明素数有无穷多个，我们只需要说明对于任意的正整数 $n$ ，皆有素数 $p$ 使得 $p>n$ 。我们考虑 $n!+1$ ，若 $n!+1$ 为素数，则显然该数比 $n$ 大；若 $n!+1$ 为合数，则其必有一素因子 $p$ ，若 $p\leqslant n$ ，那么就会有 $p|n!$ ，那么可得 $p|1$ ，显然是错误的，所以 $p>n$ ，也就是说，对于任意的正整数 $n$ ，不管 $n!+1$ 为素数还是合数，我们都能找到大于 $n$ 的素数，也就证明了素数有无限个。

&emsp;&emsp;**证明三**（此证明涉及后文知识点）：由于费马数无穷多且两两互素，若素数有限，那必然存在一个素数同时是两个费马数的真因子，那么这两个费马数就不会互素，矛盾。

&emsp;&emsp;将全体素数从小到大排列，假设 $p_n$ 表示第 $n$ 个素数， $\pi(x)$ 表示不超过 $x$ 的素数个数。下面的定理描述了 $p_n$ 的一个弱上界估计与 $\pi(x)$ 的一个弱下界估计。

&emsp;&emsp;**定理**：将全体素数从小到大排列，则第 $n$ 个素数 $p_n$ 与 $\pi(x)$ 分别有以下结论：
- $p_n\leqslant 2^{2^{n-1}},n=1,2,...$
- $\pi(x)>log_2^{log_2^x}$

&emsp;&emsp;**证明**：我们使用归纳法来证明第一个结论。当 $n=1$ 时，命题显然成立。假设对于 $n\leqslant k$ ，命题成立。当 $n=k+1$ 时，由上一个定理的证明过程可知，若 $a=p_1p_2\cdot\cdot\cdot p_k+1$ 是素数，则必然是第 $i(i\geqslant k+1)$ 个素数，则必然有 $p_{k+1}\leqslant a=p_1p_2\cdot\cdot\cdot p_k+1$ ；若 $a$ 是合数，则其最小真因子必然是一个素数，并且不出现在前 $k$ 个素数之中，那么也是第 $i(i\geqslant k+1)$ 个素数，必然也会有 $p_{k+1}\leqslant a=p_1p_2\cdot\cdot\cdot p_k+1$ ，综上，就有下面的式子：

$$\begin{align\*}
p_{k+1}\leqslant p_1p_2\cdot\cdot\cdot p_k+1=2^{2^0}2^{2^1}\cdot\cdot\cdot2^{2^{k-1}}+1=2^{2^k-1}+1<2\cdot2^{2^k-1}=2^{2^k}
\end{align\*}$$

&emsp;&emsp;于是第一个结论得证。对于第二个结论，我们用 $2^{2^k}$ 对数轴进行划分，也就是说对于任意的 $x\geqslant2$ ，必会存在唯一的整数 $n$ ，使得 $2^{2^{n-1}}\leqslant x<2^{2^n}$ ，所以不超过 $x$ 的素数的个数一定会大于不超过 $2^{2^{n-1}}$ 的素数的个数，而此时由第一个结论，第 $n$ 个素数是要小于 $2^{2^{n-1}}$ 的，所以不超过 $2^{2^{n-1}}$ 的素数至少有 $n$ 个，我们就有了下面的式子：

$$\begin{align\*}
\pi(x)\geqslant\pi(2^{2^{n-1}})\geqslant n>log_2^{log_2^x}
\end{align\*}$$

&emsp;&emsp;于是第二个结论得证。

&emsp;&emsp;下面我们介绍初等数论中一个最基本的结论：**带余除法定理**，它是整除的一般情形，也是**Euclid算法**的基础。

&emsp;&emsp;**带余除法定理**：设 $a,b$ 是两个给定的整数且 $a\neq0$ ，那么一定存在唯一的一对整数 $q$ 与 $r$ ，满足

$$\begin{align\*}
b=qa+r, 0\leqslant r<|a|
\end{align\*}$$

&emsp;&emsp;其中， $r$ 被称为 $b$ 被 $a$ 除后的**最小非负余数**，此外 $a|b$ 的充要条件是 $r=0$ 。

&emsp;&emsp;**证明**：**唯一性**：若还有整数 $q'$ 与 $r'$ 满足

$$\begin{align\*}
b=q'a+r', 0\leqslant r'<|a|
\end{align\*}$$

&emsp;&emsp;那么就会有 $0\leqslant |r'-r|<|a|$ 并且 $r'-r=(q-q')a$ ，若 $r'-r\neq0$ ，那么必有 $|a|\leqslant |r'-r|$ ，但这显然是矛盾的，所以有 $r'-r=0$ ，从而 $q'-q=0$ ，所以**唯一性**成立。至于**存在性**，当 $a|b$ 时，可取 $q=\frac{b}{a},r=0$ 。当 $a\neq b$ 时，考虑集合

$$\begin{align\*}
T=\\{b-ka|k=\pm1,\pm2,\pm3,\cdot\cdot\cdot\\}
\end{align\*}$$

&emsp;&emsp;该集合 $T$ 中必有正整数（比如取 $k=\frac{-2|ab|}{a}$ ），则 $T$ 中必有一个最小正整数，记为

$$\begin{align\*}
t_0=b-k_0a>0
\end{align\*}$$

&emsp;&emsp;因为 $a\nmid b$ ，所以 $t_0\neq|a|$ ，若 $t_0>|a|$ ，则 $t_1=t_0-|a|>0$ ，而且 $t_1\in T,t_1<t_0$ ，这与 $t_0$ 的最小性是矛盾的，所以就只有 $t_0<|a|$ ，我们取 $q=k_0,r=t_0$ 就满足要求。至于 $a|b$ 的充要条件是 $r=0$ ，这是显然的，定理得证。

&emsp;&emsp;实际上，我们可以通过带余除法对整数进行分类。设 $a\geqslant2$ 是给定的正整数， $j=0,1,2,...,a-1$ ，对于给定的 $j$ ，被 $a$ 除后余数为 $j$ 的全体整数为

$$\begin{align\*}
ak+j, k=\pm1,\pm2,\pm3,...,
\end{align\*}$$

&emsp;&emsp;这样的整数组成的集合记为 $S_{a,j}$ 。集合 $\\{S_{a,j}:0\leqslant j\leqslant a-1\\}$ 满足以下两个性质：
-  $\\{S_{a,j}:0\leqslant j\leqslant a-1\\}$ 中的任两个 $S_{a,j}$ 两两不相交，即

$$\begin{align\*}
S_{a,j}\cap S_{a,j'}=\phi,0\leqslant j\neq j'\leqslant a-1
\end{align\*}$$

-  $\\{S_{a,j}:0\leqslant j\leqslant a-1\\}$ 中所有子集的并等于 $\mathbb{Z}$ ，即

$$\begin{align\*}
\bigcup_{0\leqslant j\leqslant a-1}S_{a,j}=\mathbb{Z}
\end{align\*}$$

&emsp;&emsp;这样按被 $a$ 除后所得不同的最小非负余数，将全体整数分成了两两不相交的 $a$ 个类，这比较重要，日后会再被提及。

> 另外，余数并不是只有最小非负余数，还有最小正剩余，最小绝对剩余等等。

&emsp;&emsp;下面我们来看一道比较重要的例题。

&emsp;&emsp;例：设 $a\geqslant2$ 是给定的正整数，那么，任一正整数 $n$ 必可唯一表示为

$$\begin{align\*}
n=r_ka^k+r_{k-1}a^{k-1}+\cdot\cdot\cdot+r_1a^1+r_0
\end{align\*}$$

&emsp;&emsp;其中整数 $k\geqslant0$ ， $0\leqslant r_j\leqslant a-1(0\leqslant j\leqslant k),r_k\neq0$ 。这就是正整数 $n$ 的 $a$ 进制表示。

&emsp;&emsp;**证明**：对正整数 $n$ 必有唯一的 $k\geqslant0$ ，使得 $a^k\leqslant n<a^{k+1}$ ，由带余除法，必有唯一的 $q_0,r_0$ 满足

$$\begin{align\*}
n=q_0a+r_0,0\leqslant r_0\leqslant a-1
\end{align\*}$$

&emsp;&emsp;我们使用数学归纳法来证明这一结论。若 $k=0$ ，则必有 $q_0=0,1\leqslant r_0<a$ ，结论成立。假设 $k=m$ 时结论成立，此时

$$\begin{align\*}
a^m\leqslant n\leq a^{m+1}\\
n=r_ma^m+r_{m-1}a^{m-1}+\cdot\cdot\cdot+r_1a^1+r_0  
\end{align\*}$$

&emsp;&emsp;那么当 $k=m+1$ 时，上式中的 $q_0$ 必满足

$$\begin{align\*}
a^m\leqslant q_0\leq a^{m+1}  
\end{align\*}$$

&emsp;&emsp;根据假设，就有

$$\begin{align\*}
q_0=s_ma^m+s_{m-1}a^{m-1}+\cdot\cdot\cdot+s_1a^1+s_0  
\end{align\*}$$

&emsp;&emsp;其中 $0\leqslant s_j\leqslant a-1(0\leqslant j\leqslant m),s_m\neq0$ ，因而有

$$\begin{align\*}
n=s_ma^{m+1}+s_{m-1}a^{m}+\cdot\cdot\cdot+s_0a+r_0
\end{align\*}$$

&emsp;&emsp;即结论对 $k=m+1$ 也成立，定理得证。

&emsp;&emsp;虽然进制表示的公式看上去有些复杂，但是实际上的进制转换并没有那么复杂。比如说将十进制整数27182写成十二进制的形式，我们只需要进行下面的算法就可以了。

$$\begin{align\*}
27182=12\cdot2265+2\\
2265=12\cdot188+9\\
188=12\cdot15+8\\
15=12\cdot1+3\\
1=12\cdot0+1\\
得27182_{10}=13892_{12}
\end{align\*}$$

## 最大公因子与最小公倍数

&emsp;&emsp;**最大公因子**与**最小公倍数**是整除理论中两个最基本的概念。

&emsp;&emsp;**定义**：设 $a_1,a_2$ 是两个整数，如果 $d|a_1$ 且 $d|a_2$ ，那么就称 $d$ 是 $a_1$ 和 $a_2$ 的**公因子**。一般地，设 $a_1,a_2,...,a_k$ 是 $k$ 个整数，如果 $d|a_1,d|a_2,...,d|a_k$ ，那么就称 $d$ 是 $a_1,a_2,...,a_k$ 的**公因子**。

&emsp;&emsp;**定义**：设 $a_1,a_2$ 是两个不全为零的整数， $d$ 是 $a_1$ 和 $a_2$ 的一个正公因子，若对任意的 $d'|a_1,d'|a_2$ ，都有 $d'|d$ 成立，则称 $d$ 为 $a_1$ 和 $a_2$ 的**最大公因子**，记作 $d=(a_1,a_2)$ 或者 $d=gcd(a_1,a_2)$ 。一般地，设 $a_1,a_2,...,a_k$ 是 $k$ 个不全为零的整数， $d$ 是 $a_1,a_2,...,a_k$ 的公因子，若对任意的 $a_1,a_2,...,a_k$ 的公因子 $d'$ ，皆有 $d'|d$ ，则称 $d$ 为 $a_1,a_2,...,a_k$ 的最大公因子，记作 $(a_1,a_2,...,a_k)$ 或者 $gcd(a_1,a_2,...,a_k)$ 。

最大公因子有下面的性质：
- 对任意整数 $x$ , $(a_1,a_2)=(a_1,a_2+a_1x)$  
  证明也很容易，令 $d=(a_1,a_2),d'=(a_1,a_2+a_1x)$ ，那么就会有 $d'|a_1,d'|a_2+a_1x$ ，所以就会有 $d'|a_2$ ，那么 $d'$ 作为 $a_1$ 和 $a_2$ 的公因子，一定就有 $d'|d$ ； $d|a_1$ 且 $d|a_2$ ，就会有 $d|a_2+a_1x$ ，那么 $d$ 作为 $a_1$ 和 $a_2+a_1x$ 的公因子，就会有 $d|d'$ ，
所以 $d'=d$ ，性质得证。
- 设 $m>0$ ，则 $m(b_1,b_2,...,b_k)=(mb_1,mb_2,mb_3,...,mb_k)$  
  令 $d=(b_1,b_2,...,b_k),d'=(mb_1,mb_2,mb_3,...,mb_k)$ ，也就是有 $d|b_i(1\leqslant i\leqslant k)$ ，那么一定会有 $md|mb_i(1\leqslant i\leqslant k)$ ，所以就有 $md|d'$ ，反之，由于 $m|mb_i$ ，那必然会有 $m|d'$ ，也就是 $d'=qm,qm|mb_i$ ，所以 $q|b_i$ ，就有 $q|d$ ，也就是 $mq|md$ ，即 $d'|md$ ，所以 $d'=md$ ，命题得证。
- 设 $a_1,a_2$ 是两个不全为零的整数，则 $(\frac{a_1}{(a_1,a_2)},\frac{a_2}{(a_1,a_2)})=1$ 。更一般地，有

$$\begin{align\*}
(\frac{a_1}{(a_1,a_2,...,a_k)},...,\frac{a_k}{(a_1,a_2,...,a_k)})=1
\end{align\*}$$

&emsp;&emsp;用反证法即可证明，这里不再赘述。
- $(a_1,a_2)=(a_1,a_2,xa_1)=(a_1,a_2,xa_2)$  
  令 $d=(a_1,a_2),d'=(a_1,a_2,xa_1)$ ，显然有 $d'|a_1,d'|a_2$ ，也就是 $d'|d$ ，同理有 $d|d'$ ，所以 $d'=d$ ，性质得证。
- $(a_1,a_2,a_3)=((a_1,a_2),a_3)$   
  令 $d=(a_1,a_2,a_3),d'=((a_1,a_2),a_3)$ ，所以 $d|a_1$ 且 $d|a_2$ ，那么 $d|(a_1,a_2)$ ， 又因为 $d|a_3$ ，所以 $d|d'$ ，反之同理有 $d'|d$ ，所以 $d'=d$ ，性质得证。 
- $(a_1,··· ,a_{k+r})=((a_1,...,a_k),(a_{k+1},...,a_{k+r}))$ （上一条性质的广义版本）  

&emsp;&emsp;实际上，第一条性质为我们提供了一种求解最大公因子的简单方法，就是两数不断相减：

$$\begin{align\*}
(442,87)=(442-87\times5,87)=(7,87)=(7,87-7\times12)=(7,3)=1
\end{align\*}$$

&emsp;&emsp;下面我们来看一道经典例题：

&emsp;&emsp;设 $a>2$ 是奇数，证明：  
&emsp;&emsp;(1)一定存在正整数 $d\leqslant a-1$ ，使得 $a|2^d-1$ 。  
&emsp;&emsp;(2)设 $d_0$ 是满足 $a|2^d-1$ 的最小正整数，那么 $a|2^h-1$ 的充要条件是 $d_0|h$ 。  
&emsp;&emsp;(3)必有正整数 $d$ 使得 $(2^d-3,a)=1$ 。  

&emsp;&emsp;**证明**：**(1)** 考虑以下 $a$ 个数

$$\begin{align\*}
2^0,2^1,2^2,2^3,...,2^{a-1}
\end{align\*}$$

&emsp;&emsp;由 $a\nmid 2^j(0\leqslant j<a)$ 以及带余除法知，对于每个 $j$ ，都有 $2^j=q_ja+r_j,0<r_j<a$ ，这 $a$ 个余数 $r_0,r_1,r_2,...,r_{a-1}$ 仅可能取 $a-1$ 个值，那么必然有两个余数是相等的，不妨设 $0\leqslant i<k<a$ 且 $r_i=r_k$ ，因而有

$$\begin{align\*}
a(q_k-q_i)=2^k-2^i=2^i(2^{k-i}-1)
\end{align\*}$$

&emsp;&emsp;由 $(a,2)=1$ ，推出 $a|2^{k-i}-1$ 。取 $d=k-i\leqslant a-1$ 就满足要求。

&emsp;&emsp; **(2)** 充分性：若 $d_0|h$ ，也就是 $h=qd_0$ ，所以 $2^h-1=(2^{d_0})^q-1=(2^{d_0}-1)(\cdot\cdot\cdot)$ ，所以有 $a|2^h-1$ 。  
&emsp;&emsp;   必要性：由带余除法定理可得 $h=qd_0+r,0\leqslant r<d_0$ ，所以有：


$$\begin{align\*}
2^h-1=2^{qd_0+r}-2^r+2^r-1=2^r(2^{qd_0}-1)+(2^r-1)
\end{align\*}$$

&emsp;&emsp;由于 $a|2^h-1$ 并且 $a|2^{qd_0}-1$ ，所以 $a|2^r-1$ ，注意到 $r$ 作为余数应小于 $d_0$ ，但 $d_0$ 又是满足 $a|2^d-1$ 的最小正整数，所以 $r=0$ ，所以就有 $d_0|h$ 。 

&emsp;&emsp; **(3)** 由(1)知，存在 $d$ 使得 $a|2^d-1$ ，那么 $(2^d-3,a)=(2^d-1-2,a)=(-2,a)=1$ ，得证。

&emsp;&emsp;**定义**：设 $a_1,a_2$ 是两个整数，若 $(a_1,a_2)=1$ ，则称 $a_1$ 和 $a_2$ 是既约的（或者说是互素的），若 $(a_1,a_2,...,a_k)=1$ ，那么就称 $a_1,a_2,...,a_k$ 是互素的。

&emsp;&emsp;下面我们来看一道经典例题，费马数。

&emsp;&emsp;例：费马数 $F_n$ 定义： $F_n=(2)^{2^n}-1$ ，其中 $n$ 为非负整数，证明：任意两个不同的Fermat数互素。

&emsp;&emsp;**证明**：对任意两个不同的费马数 $F_n,F_m$ ，不妨设 $n=m+k,k>0$ ，我们有：

$$\begin{align\*}
\frac{F_n-2}{F_m}=\frac{F_{m+k}-2}{F_m}=\frac{2^{2^{m+k}}-1}{2^{2^m}+1}=\frac{(2^{2^m})^{2^k}-1}{2^{2^m}+1}
\end{align\*}$$

&emsp;&emsp;所以有 $F_m|F_n-2$ ，由 

$$\begin{align\*}
(F_m,F_n)|F_n,(F_m,F_n)|F_n-2
\end{align\*}$$

&emsp;&emsp;所以有 $(F_m,F_n)|2$ ，又因为费马数都是奇数，公因子不可能是2，所以 $(F_m,F_n)=1$ ，得证。

&emsp;&emsp;其实根据上述过程我们能够得到：

$$\begin{align\*}
F_n=\prod_{i=0}^{n-1}F_i+2
\end{align\*}$$

&emsp;&emsp;为什么会这样呢？其实是因为前面证明出的结论： $F_m|F_n-2$ ，如果 $m$ 从0取到 $n-1$ ，那么就有 $F_0|F_n-2,F_1|F_n-2,...,F_{n-1}|F_n-2$ ，但是又因为前 $n$ 个费马数两两互素，所以前 $n$ 个费马数皆是 $F_n$ 的因子，也就是有：

$$\begin{align\*}
F_n-2=q_nF_0F_1F_2...F_{n-1}(q_n依然是未知的)
\end{align\*}$$

&emsp;&emsp;接下来只需使用数学归纳法证明对于任意的费马数 $F_n$ 皆有 $q_n=1$ 即可。（实际上，写到这里的时候我突然反应过来，其实可以一开始就直接使用数学归纳法来证明这个结论，可以省去前面一段分析。）

> 费马数这一两两互素的性质也可以用于证明素数有无穷多个，对应证明于前文提到过。另外，费马（1601-1665）曾猜测费马数都是素数，但是被欧拉心算验证 $F_5=4294967297$ 不是素数（是的，晚年欧拉失明，只能心算结果），至今我们也没发现过新的费马素数。

&emsp;&emsp;下面我们来补充一些关于公因数的重要性质。

&emsp;&emsp;**定理**：设 $(m,a)=1$ ，则有 $(m,ab)=(m,b)$    
- 证明：若 $m=0$ ，则 $a=\pm1$ ，结果显然成立；当 $m\neq0$ ，则有：

$$\begin{align\*}
(m,b)=(m,b(m,a))=(m,(mb,ab))=(m,mb,ab)=(m,ab)
\end{align\*}$$

- **推论**：设 $(m,a)=1$ ， $n$ 是正整数，则有 $(m,a^n)=1$ (取 $b=a$ 反复使用定理即可)   
- **推论**：设 $(a,b)=1$ ， $k,t$ 是正整数，则有 $(a^k,b^t)=1$ (反复使用定理即可)  

&emsp;&emsp;**定理**：设 $(m,a)=1$ ，若 $m|ab$ ，则 $m|b$
- 证明：由于 $m|ab$ ，那么 $|m|=(m,ab)$ ，又因为 $(m,a)=1$ ，所以 $(m,ab)=(m,b)$ ，即 $|m|=(m,b)$ ，所以有 $m|b$ 。
- **推论**：设 $p$ 是一个素数且 $p|ab$ ，那么 $p|a$ 或者 $p|b$ 。
  
&emsp;&emsp;看完了最大公因子，下面我们来看一下最小公倍数。

&emsp;&emsp;**定义**：设 $a_1,a_2$ 是两个均不等于0的整数，如果 $a_1|l,a_2|l$ ，则称 $l$ 是 $a_1$ 和 $a_2$ 的**公倍数**。一般地，设 $a_1,a_2,...,a_k$ 是 $k$ 个均不等于0的整数，如果 $a_1|l,...,a_k|l$ ，则称 $l$ 是 $a_1,a_2,...,a_k$ 的公倍数。

&emsp;&emsp;**定义**：设 $a_1,a_2$ 是两个均不等于0的整数， $l$ 是 $a_1$ 和 $a_2$ 的一个正公倍数，若对 $a_1,a_2$ 的任意公倍数 $l'$ ，有 $l|l'$ ，称 $l$ 是 $a_1$ 和 $a_2$ 的**最小公倍数**，记作 $\[a_1,a_2\]$ 。一般地，设 $a_1,a_2,...,a_k$ 是 $k$ 个均不等于0的整数， $l$ 是 $a_1,a_2,...,a_k$ 的一个正公倍数，如果对于 $a_1,a_2,...,a_k$ 的任意公倍数 $l'$ ，皆有 $l|l'$ ，称 $l$ 是 $a_1,a_2,...,a_k$ 的最小公倍数，记作 $\[a_1,a_2,...,a_k\]$ 。

&emsp;&emsp;最小公倍数的性质：
- 若 $a_2|a_1$ ，则 $\[a_1,a_2\]=|a_1|$  
  若 $a_j|a_1,2\leqslant j\leqslant k$ ，则 $\[a_1,a_2,...,a_k\]=|a_1|$
- 对于任意的 $d|a_1$ ， $\[a_1,a_2\]=\[a_1,a_2,d\]$
- 设 $m>0$ ，我们有 $\[ma_1,ma_2,...,ma_k\]=m\[a_1,a_2,...,a_k\]$   

&emsp;&emsp;**定理**：$\[a_1,a_2\](a_1,a_2)=|a_1a_2|$ 

&emsp;&emsp;**证明**：当 $(a_1,a_2)=1$ 时，由于 $|a_1a_2|$ 是 $a_1$ 和 $a_2$ 的一个公倍数，所以 $\[a_1,a_2\]||a_1a_2|$ ，另外，由于 $a_1|\[a_1,a_2\]=a_1m$ ，所以 $a_2|\[a_1,a_2\]=a_1m$ ，但又因为 $a_1$ 和 $a_2$ 互质，所以 $a_2|m$ ，所以 $|a_1a_2||\[a_1,a_2\]$ ，也就有 $|a_1a_2|=\[a_1,a_2\]$ 。若 $(a_1,a_2)\neq1$ ，由最大公因子性质得：

$$\begin{align\*}
(\frac{a_1}{(a_1,a_2)},\frac{a_2}{(a_1,a_2)})=1
\end{align\*}$$

&emsp;&emsp;此时就有 $\frac{a_1}{(a_1,a_2)},\frac{a_2}{(a_1,a_2)}$ 互质，由前面的结论，就有：

$$\begin{align\*}
\[\frac{a_1}{(a_1,a_2)},\frac{a_2}{(a_1,a_2)}\]=\frac{|a_1a_2|}{(a_1,a_2)^2}
\end{align\*}$$

&emsp;&emsp;两边同乘 $(a_1,a_2)^2$ 即得结论。

> 其实该定理也给出了一种最小公倍数的求解办法。

&emsp;&emsp;设 $k$ 是正整数，证明：  
&emsp;&emsp;(1) $(a^k,b^k)=(a,b)^k$   
&emsp;&emsp;(2)设 $a,b$ 是整数，若 $(a,b)=1,ab=c^k$ ，则 $a=(a,c)^k,b=(b,c)^k$ 。

&emsp;&emsp;**证明**：**(1)**

$$\begin{align\*}
(a^k,b^k)=(a,b)^k(\frac{a^k}{(a,b)^k},\frac{b^k}{(a,b)^k})=(a,b)^k((\frac{a}{(a,b)})^k,(\frac{b}{(a,b)})^k)
\end{align\*}$$

&emsp;&emsp;而

$$\begin{align\*}
((\frac{a}{(a,b)}),(\frac{b}{(a,b)}))=1
\end{align\*}$$

&emsp;&emsp;所以有

$$\begin{align\*}
((\frac{a}{(a,b)})^k,(\frac{b}{(a,b)})^k)=1
\end{align\*}$$

&emsp;&emsp;得证。  
&emsp;&emsp;**(2)**：由 $(a,b)=1$ 可得 $(a^{k-1},b)=1$ ，从而

$$\begin{align\*}
a=a(a^{k-1},b)=(a^k,ab)=(a^k,c^k)=(a,c)^k (这里是第一问的结论）
\end{align\*}$$

&emsp;&emsp;同理可得 $b=(b,c)^k$ 。

&emsp;&emsp;**例**：设 $p$ 是素数，证明： $\sqrt{p}$ 不是有理数。

&emsp;&emsp;**证明**：设 $\frac{a}{b}=\sqrt{p}$ ， $(a,b)=1$ ，则 $\frac{a^2}{b^2}=p$ ，也就是 $pb^2=a^2$ ，所以 $p|a^2$ ，所以 $p|a$ ，不妨记 $a=xp$ ，则 $pb^2=p^2x^2$ ，则 $px^2=b^2$ ，那么 $p|b^2$ ，所以 $p|b$ ，这与 $(a,b)=1$ 矛盾，得证。

## Euclid算法

&emsp;&emsp;**Euclid算法**（又叫辗转相除法），是数学领域最基本的算法之一，该算法基于下面这个基本定理（其实在前面我们已经提到过）：

&emsp;&emsp;设 $a,b\in Z,b\neq0$ ，作带余除法有 $a=qb+r$ ，则 $(a,b)=(b,r)$ 。

&emsp;&emsp;下面我们来一步一步拆解算法流程，欲求 $d=(a,b)$ ：  
&emsp;&emsp;**第1步**：使用带余除法

$$\begin{align\*}
a=q_0b+r_0,0\leqslant r_0\leqslant b-1
\end{align\*}$$

&emsp;&emsp;根据最大公因子的性质就有：

$$\begin{align\*}
(a,b)=(a-q_0b,b)=(b,r_0)
\end{align\*}$$

&emsp;&emsp;如果 $r_0=0$ ，那么 $d=(b,r_0)=b$ ，该算法结束。但如果 $r_0\neq0$ ，那么进行第二步：  
&emsp;&emsp;**第2步**：继续使用带余除法

$$\begin{align\*}
b=q_1r_0+r_1,0\leqslant r_1\leqslant r_0
\end{align\*}$$

&emsp;&emsp;那么就有 $d=(b,r_0)=(r_0,r_1)$ ，若 $r_1\neq0$ 就继续进行下去。

&emsp;&emsp;**第i步**：继续使用带余除法

$$\begin{align\*}
r_{i-3}=q_{i-1}r_{i-2}+r_{i-1},0\leqslant r_{i-1}\leqslant r_{i-2}-1
\end{align\*}$$

&emsp;&emsp;那么就有 $d=(r_{i-3},r_{i-2})=(r_{i-2},r_{i-1})$ ，若 $r_{i-1}\neq0$ 就继续进行下去。

&emsp;&emsp;但是这个算法必然会有终止的时候，这主要是因为我们后续作带余除法的余数会越来越小，而我们所得到的第一个余数是小于 $b$ 的，那么后续的余数会单调递减的出现，而 $b$ 前面只有有限个非负整数，所以这个算法一定会终止。

&emsp;&emsp;**最后两步**：算法的最后就会像下面这样：

$$\begin{align\*}
r_{k-2}=q_kr_{k-1}+r_k ,0\leqslant r_k\leqslant r_{k-1}-1 \\
r_{k-1}=q_{k+1}r_k+0
\end{align\*}$$

&emsp;&emsp;最后 $d=(r_{k-2},r_{k-1})=(r_{k-1},r_k)=r_k$ ，算法结束。

&emsp;&emsp;下面我们用一个表格来说明这个算法的过程：

| 第 $i$ 步 | 带余除法表达式 | 余数范围 | 原求解 | 现求解 |
| ------- | -------------- | -------- | ------ | ------ |
|   1     |$a=q_0b+r_0$    |$0\leqslant r_0\leqslant b-1$|$(a,b)$  |$(b,r_0)$|
|   2     |$b=q_1r_0+r_1$  |$0\leqslant r_1\leqslant r_0$|$(b,r_0)$|$(r_0,r_1)$|
|   3     |$r_0=q_2r_1+r_2$|$0\leqslant r_2\leqslant r_1$|$(r_0,r_1)$|$(r_1,r_2)$|
|$\cdot\cdot\cdot$|$\cdot\cdot\cdot$|$\cdot\cdot\cdot$|$\cdot\cdot\cdot$|$\cdot\cdot\cdot$|
|  $i$    |$r_{i-3}=q_{i-1}r_{i-2}+r_{i-1}$|$0\leqslant r_{i-1}\leqslant r_{i-2}-1$|$(r_{i-3},r_{i-2})$|$(r_{i-2},r_{i-1})$|
|$\cdot\cdot\cdot$|$\cdot\cdot\cdot$|$\cdot\cdot\cdot$|$\cdot\cdot\cdot$|$\cdot\cdot\cdot$|
|   $k$   |$r_{k-3}=q_kr_{k-2}+r_{k-1}$|$0\leqslant r_{k-1}\leqslant r_{k-2}-1$|$(r_{k-3},r_{k-2})$|$(r_{k-2},r_{k-1})$|
|$k+1$    |$r_{k-2}=q_kr_{k-1}+r_k$|$0\leqslant r_k\leqslant r_{k-1}-1$|$(r_{k-2},r_{k-1})$|$(r_{k-1},r_{k})$|
|$k+2$    |$r_{k-1}=q_{k+1}r_k+0$| |$(r_{k-1},r_{k})$|$r_k$|

&emsp;&emsp;根据上面的过程，我们不仅能得到 $r_k=(a,b)$ ，还能得到意外的收获：由第 $k+1$ 个式子，我们能得到 $r_k$ 也就是 $(a,b)$ 表示成 $r_{k-1}$ 和 $r_{k-2}$ 的整系数多项式，再由第 $k$ 个式子得到 $r_{k-1}=r_{k-3}-q_{k-1}r_{k-2}$ ，将其代入第 $k+1$ 个式子，就可得到 $(a,b)$ 表示成 $r_{k-2}$ 和 $r_{k-3}$ 的整系数多项式，这样继续从前面往回代入，最后就能得到 $(a,b)$ 表示成 $a$ 和 $b$ 的整系数多项式，也就是我们下面的定理：

&emsp;&emsp;**裴蜀定理**：存在整数 $x_0,x_1$ ，使得 $(a,b)=ax_0+bx_1$ 。  
&emsp;&emsp;**定理推论**：设 $a_1,a_2,...,a_k$ 是不全为零的整数，那么一定存在一组整数 $x_1,...,x_k$ ，使得：

$$\begin{align\*}
(a_1,a_2,...,a_k)=a_1x_1+a_2x_2+...+a_kx_k
\end{align\*}$$

&emsp;&emsp;下面我们来看一道例题，具体了解一下上述过程。  
&emsp;&emsp;求42823及6409的最大公因子，并将它表示成42823和6409的整系数线性组合形式。

&emsp;&emsp;由Euclid算法可得：

$$\begin{align\*}
42823=6\times6409+4369\\
6409=1\times4369+2040\\
4369=2\times2040+289\\
2040=7\times289+17\\
289=17\times17\\
\end{align\*}$$

&emsp;&emsp;即(42823,6049)=17，求解整系数线性组合只需将上述过程倒过来即可：

$$\begin{align\*}
17=2040-7\times289\\
17=2040-7\times(4369-2\times2040)=-7\times4369+15\times2040\\
17=-7\times4369+15\times(6409-1\times4369)=-22\times4369+15\times6409\\
17=-22\times(42823-6\times6409)+15\times6409=-22\times42823+147\times6409\\
\end{align\*}$$

&emsp;&emsp;这就求出了线性组合的形式： $(42823,6049)=-22\times42823+147\times6409$ 

&emsp;&emsp;**定理**： $(a,b)=1$ 当且仅当存在整数 $m,n$ 使得 $am+bn=1$ 。
- 证明：若 $(a,b)=1$ ，由裴蜀定理即可；若 $am+bn=1$ ，由于 $(a,b)|a$ ， $(a,b)|b$ ，所以 $(a,b)|am+bn=1$ ，故 $(a,b)=1$ 。
- **推论**：若 $(a,b)=1$ ，则任一整数 $n$ 必可表示为 $a,b$ 的整系数线性组合的形式。
- 推论证明：由 $(a,b)=1$ ，故存在整数 $x_0,y_0$ 使得 $ax_0+by_0=1$ ，取 $x=nx_0,y=ny_0$ 。

&emsp;&emsp;**例**：设 $a,m,n$ 是正整数并且 $a\geqslant 2$ ，证明：$(a^m-1,a^n-1)=a^{(m,n)}-1$ 。

&emsp;&emsp;**证明**：不妨设 $m\geqslant n$ 。由带余除法得 $m=q_1n+r,0\leqslant r<n$ ，于是就有：

$$\begin{align\*}
a^m-1=a^{q_1n+r}-a^r+a^r-1=a^r(a^{q_1n}-1)+a^r-1
\end{align\*}$$

&emsp;&emsp;由于 $a^n-1|a^{q_1n}-1$ ，所以：

$$\begin{align\*}
(a^m-1,a^n-1)=(a^n-1,a^r-1)
\end{align\*}$$

&emsp;&emsp;注意到 $(m,n)=(n,r)$ ，若 $r=0$ ，则 $(m,n)=n$ ，结论成立，若 $r>0$ ，则继续作同样讨论，由辗转相除法可知结论成立。

&emsp;&emsp;试证任意两个相邻的斐波那契数互素。

&emsp;&emsp;证明：如果我们视如下的过程为欧几里得算法：

$$\begin{align\*}
f_{k+1}=1\times f_k+f_{k-1}\\
f_{k}=1\times f_{k-1}+f_{k-2}\\
f_{k-1}=1\times f_{k-2}+f_{k-3}\\
\cdot\cdot\cdot\\
f_{5}=1\times f_{4}+f_{3}\\
f_{4}=1\times f_{3}+f_{2}\\
f_{3}=1\times f_{2}+f_{1}=2f_{2}\\
\end{align\*}$$

&emsp;&emsp;所以 $(f_{k+1},f_k)=(f_3,f_2)=(2,1)=1$，例题得证。

## 求解一次不定方程

&emsp;&emsp;所谓的一次不定方程的一般形式是 $a_1x_1+a_2x_2+...+a_kx_k=c$ ，其中整数 $k\geqslant 2,c,a_1,...,a_k$ 是整数，且 $a_1,...,a_k$都不等于零， $x_1,...,x_k$ 是整数变量。我们首先给出该方程有解的一个充要条件。

&emsp;&emsp;**定理**：不定方程 $a_1x_1+a_2x_2+...+a_kx_k=c$ 有解的充要条件是 $(a_1,...,a_k)|c$ 。当并且当该不定方程有解时，它的解与不定方程

$$\begin{align\*}
\frac{a_1}{d}x_1+\cdot\cdot\cdot+\frac{a_k}{d}x_k=\frac{c}{d}
\end{align\*}$$

&emsp;&emsp;的解相同，这里 $d=(a_1,a_2,...,a_k)$

&emsp;&emsp;**证明**：如果方程有解，则必然有 $(a_1,...,a_k)|c$ ，否则就会出现等式左边为整数而等式右边为分数的矛盾。若 $(a_1,...,a_k)|c$ ，不妨设 $c=(a_1,...,a_k)c_1$ ，由裴蜀定理，必然有：

$$\begin{align\*}
a_1y_1+a_2y_2+...+a_ky_k=(a_1,...,a_k)
\end{align\*}$$

&emsp;&emsp;那么 $x_1=c_1y_1,...,x_k=c_ky_k$ 就是原不定方程的一组解，命题得证。

&emsp;&emsp;**定理**：设二元一次不定方程 $a_1x_1+a_2x_2=c$ 有解，若 $x_{1,0},x_{2,0}$ 是它的一组解，那么它所有的解是：

$$\begin{align\*}
\begin{cases}
x_1=x_{1,0}+\frac{a_2}{(a_1,a_2)}t\\
x_2=x_{2,0}-\frac{a_1}{(a_1,a_2)}t\\
\end{cases}
\end{align\*}$$

&emsp;&emsp;其中 $t=0,\pm1,\pm2,...$ 

&emsp;&emsp;证明：容易验证定理给出的每一对 $x_1,x_2$ 为该二元一次不定方程的解，反过来，设 $x_1,x_2$ 是该二元一次不定方程的解，那么有：

$$\begin{align\*}
a_1x_1+a_2x_2=a_1x_{1,0}+a_2x_{2,0}\\
\therefore a_1(x_1-x_{1,0})=-a_2(x_2-x_{2,0})\\
\frac{a_1}{(a_1,a_2)}(x_1-x_{1,0})=-\frac{a_2}{(a_1,a_2)}(x_2-x_{2,0})\\
\end{align\*}$$

由于 $(\frac{a_1}{(a_1,a_2)},\frac{a_2}{(a_1,a_2)})=1$ ，所以

$$\begin{align\*}
x_1-x_{1,0}=\frac{a_2}{(a_1,a_2)}t,x_2-x_{2,0}=-\frac{a_1}{(a_1,a_2)}t
\end{align\*}$$

&emsp;&emsp;求解二元一次不定方程的步骤并不复杂，先判断是否有解，有解则设法求出一组特解，之后再利用公式给出全部解。

## 整数的素分解

&emsp;&emsp;**引理**：设 $p$ 是素数且 $p|a_1a_2$ ，那么 $p|a_1$ 或者 $p|a_2$ 至少有一个成立，一般地，如果 $p|a_1\cdot\cdot\cdot a_k$ ，那么 $p|a_1,p|a_2,...,p|a_k$ 至少有一个成立。
- 其实我们在前面最大公因子那一节已经有过这个结论。

&emsp;&emsp;**算术基本定理**：设 $a>1$ ，那么，必有：

$$\begin{align\*}
a=p_1p_2\cdot\cdot\cdot p_s
\end{align\*}$$

&emsp;&emsp;其中 $p_j(1\leqslant j\leqslant s)$ 是素数，且在不计次序的意义下，该表达式是唯一的。

&emsp;&emsp;**证明**：存在性：使用数学归纳法，当 $a=2$ 时，2是素数，结论成立。假设当 $2\leqslant a<n$ 时，结论成立，那么当 $a=n$ 时，若 $n$ 是素数，则结论成立，若 $n$ 是合数，则必有 $n=n_1n_2$ ，由于 $2\leqslant n_1,n_2<n$ ，所以 $n_1,n_2$ 皆可表示为素数的成绩，所以 $n$ 也都可表示为素数的乘积。

&emsp;&emsp;唯一性：若有两种形式的素分解：

$$\begin{align\*}
a=p_1p_2\cdot\cdot\cdot p_s,1\leqslant p_1\leqslant p_2\leqslant\cdot\cdot\cdot\leqslant p_s\\
a=q_1q_2\cdot\cdot\cdot q_r,1\leqslant q_1\leqslant q_2\leqslant\cdot\cdot\cdot\leqslant q_r\\
\end{align\*}$$

&emsp;&emsp;其中 $p_i(1\leqslant i\leqslant s),q_i(1\leqslant i\leqslant r)$ 是素数，不妨设 $s\leqslant r$ ，我们来证明必有 $r=s,p_i=q_i(1\leqslant i\leqslant s)$ ，由 $q_1|a=p_1p_2\cdot\cdot\cdot p_s$ 可知必有一个 $p_j$ 满足 $q_1|p_j$ ，由于 $q_1,p_j$ 都是素数，故 $q_1=p_j$ ，同样，由 $p_1|a=q_1q_2\cdot\cdot\cdot q_r$ 可知必有一个 $q_i$ 满足 $p_1|q_i$ ，因而 $p_1=q_i$ ，由于 $q_1\leqslant q_i=p_1\leqslant p_j$ ，所以 $p_1=q_1$ 。因此：

$$\begin{align\*}
p_2\cdot\cdot\cdot p_s=q_2\cdot\cdot\cdot q_r
\end{align\*}$$

同理可得：

$$\begin{align\*}
q_2=p_2,...,q_s=p_s,q_{s+1}=1,...,q_r=1
\end{align\*}$$

故不存在 $q_{s+1},...,q_r$ ，即 $r=s$ 。定理得证。

&emsp;&emsp;**推论**：设 $a>1$ ，那么必有

$$\begin{align\*}
a=p_1^{\alpha_1}\cdot\cdot\cdot p_s^{\alpha_s}
\end{align\*}$$

&emsp;&emsp;其中， $p_1<p_2<...<p_s$ ，该式也被称为 $a$ 的标准素因数分解式。

&emsp;&emsp;**推论**：设 $a=p_1^{\alpha_1}\cdot\cdot\cdot p_s^{\alpha_s}$ 且 $p_i$ 是互不相同的素数，那么 $d$ 是 $a$ 的正因数的充要条件是：

$$\begin{align\*}
d=p_1^{e_1}\cdot\cdot\cdot p_s^{e_s},0\leqslant e_j\leqslant\alpha_j,1\leqslant j\leqslant s
\end{align\*}$$

&emsp;&emsp;**推论**：设：

$$\begin{align\*}
a=p_1^{\alpha_1}\cdot\cdot\cdot p_s^{\alpha_s}\\
b=p_1^{\beta_1}\cdot\cdot\cdot p_s^{\beta_s}\\
\end{align\*}$$

&emsp;&emsp;这里 $p_1<p_2<...<p_s$ 并且允许某个 $\alpha_j$ 和 $\beta_j$ 为零，那么：

$$\begin{align\*}
(a,b)=p_1^{\delta_1}\cdot\cdot\cdot p_s^{\delta_s},\delta_j=min(\alpha_j,\beta_j),1\leqslant j\leqslant s\\
\[a,b\]=p_1^{\gamma_1}\cdot\cdot\cdot p_s^{\gamma_s},\gamma_j=max(\alpha_j,\beta_j),1\leqslant j\leqslant s
\end{align\*}$$

&emsp;&emsp;**推论**：设 $a$ 是正整数， $\tau(a)$ 表示 $a$ 的所有正除数的个数，若 $a$ 有标准素因数分解式 $p_1^{\alpha_1}\cdot\cdot\cdot p_s^{\alpha_s}$ ，那么：

$$\begin{align\*}
\tau(a)=(\alpha_1+1)\cdot\cdot\cdot (\alpha_s+1)=\tau(p_1^{\alpha_1})\cdot\cdot\cdot\tau(p_s^{\alpha_s})
\end{align\*}$$

&emsp;&emsp;这也不难理解，每一个 $p_1^{\alpha_1}$ 都会包含 $\alpha_1+1$ 个正除数（包括1），最后使用分步乘法计数原理即可。

&emsp;&emsp;**推论**：设整数 $a\geqslant 2$ :  
&emsp;&emsp;(1)若 $a$ 是合数，则必有不可约数 $p|a,p\leqslant a^{\frac{1}{2}}$    
&emsp;&emsp;(2)若 $a=p_1p_2\cdot\cdot\cdot p_s$ ，则必有不可约数 $p|a,p\leqslant a^{\frac{1}{s}}$

&emsp;&emsp;下面我们来介绍一个十分重要的数论函数 $\[x\]$ 。

&emsp;&emsp;设 $x$ 是实数， $\[x\]$ 表示不超过 $x$ 的最大整数，称为 $x$ 的整数部分，即 $\[x\]$ 是一个整数并且满足  $\[x\]\leqslant x<\[x\]+1$ ，记 $\\{x\\}=x-\[x\]$ ，称其为 $x$ 的小数部分，显然 $0\leqslant\\{x\\}<1$ ，且 $x$ 是整数的充要条件是 $\\{x\\}=0$ 。

&emsp;&emsp;该函数有如下性质：
- (1)若 $x\leqslant y$ ，则 $\[x\]\leqslant\[y\]$     
  由 $\[x\]\leqslant x\leqslant y<y+1$ 可得   
- (2)若 $x=m+v$ ， $m$ 是整数， $0\leqslant v<1$ ，则 $m=\[x\],v=\\{x\\}$   
- (3)对任意整数 $m$ 有 $\[x+m\]=\[x\]+m,\\{x+m\\}=\\{x\\}$ ， $\{x\}$ 是周期为1的周期函数。  
  由 $\[x\]+m\leqslant x+m<\[x\]+m+1$ 可得。
- (4) $\[x\]+\[y\]\leqslant\[x+y\]\leqslant\[x\]+\[y\]+1$ ，其中等号有且仅有一个成立。  
  对 $x,y$ 的小数部分分类讨论即可。
- (5)

$$\begin{align\*}
\[-x\]=
\begin{cases}
-\[x\] ,x\in Z\\
-\[x\]-1 ,x\notin Z\\
\end{cases}
\\{-x\\}=
\begin{cases}
-\\{x\\}=0,x\in Z\\
1-\\{x\\},x\notin Z\\
\end{cases}
\end{align\*}$$

&emsp;&emsp;当 $x$ 不是整数时， $-x=-\[x\]-\\{x\\}=-\[x\]-1+1-\\{x\\},0\leqslant 1-\\{x\\}<1$
- (6)对正整数 $m$ 有 $\[\frac{\[x\]}{m}\]=\[\frac{x}{m}\]$    
  由带余除法，存在整数 $q,r$ 使得 $\[x\]=qm+r,0\leqslant r<m$ ,所以 $\[x\]/m=q+r/m,0\leqslant r/m<1$ ,也就有 $\[\[x\]/m\]=q$ ，另一方面， $x/m=\[x\]/m+\\{x\\}/m=q+(\\{x\\}+r)/m$ ，但是由于 $0\leqslant(\\{x\\}+r)/m<1$ ，所以 $\[x/m\]=q$ 
- (7)不小于 $x$ 的最小整数是 $-\[-x\]$    
  设不小于 $x$ 的最小整数是 $a$ ，那就有 $a-1<x\leqslant a$ ，所以 $-a\leqslant -x<-a+1$ ，所以 $-a=-\[-x\]$
- (8)设 $a,N$ 是正整数，那么正整数 $1,2,...,N$ 中被 $a$ 整除的正整数个数是 $\[N/a\]$
  被 $a$ 整除的正整数是 $a,2a,3a,...$ ，那必然存在一个 $k$ ，使得 $ka\leqslant N<(k+1)a$ ， 也就有 $k\leqslant N/a<(k+1)$ 。

&emsp;&emsp;**定义**：设 $k$ 是非负整数，符号 $a^k||b$ 表示 $b$ 恰好被 $a$ 的 $k$ 次方整除，即 $a^k|b,a^{k+1}\nmid b$ 。

&emsp;&emsp;**定理**：设 $n$ 是正整数， $p$ 是素数，将满足 $p^{\alpha}||n!$ 的 $\alpha$ 记作 $\alpha(p,n)$ ，那么有：

$$\begin{align\*}
\alpha=\alpha(p,n)=\sum_{j=1}^{\infty}\[\frac{n}{p^j}\]
\end{align\*}$$

&emsp;&emsp;**证明**：该等式实际上是有限和，因为必然存在 $k$ 使得 $p^k\leqslant n<p^{k+1}$ ，所以即证：

$$\begin{align\*}
\alpha=\alpha(p,n)=\sum_{j=1}^{k}\[\frac{n}{p^j}\]
\end{align\*}$$
  
&emsp;&emsp;设 $j$ 是给定的正整数， $c_j$ 表示 $1,2,...,n$ 中能够被 $p^j$ 整除的数的个数， $d_j$ 表示 $1,2,...,n$ 中恰好能被 $p^j$ 整除的数的个数，那么有 $d_j=c_j-c_{j-1}$ ，并且当 $j>k$ 时， $d_j=c_j=0$ ，由数论函数的性质，我们是可以表示出 $c_j$ 的，也就有：

$$\begin{align\*}
d_j=\[\frac{n}{p^j}\]-\[\frac{n}{p^{j+1}}\]
\end{align\*}$$

&emsp;&emsp;下面将 $1,2,...,n$ 分为两两不交的 $k$ 个集合，第 $j$ 个集合中放置恰好能被 $p^j$ 整除的数，也就是有 $d_j$ 个元素，所以这 $d_j$ 个元素的乘积恰好能够被 $(p^j)^{d_j}$ 次方整除，由于 $n!$ 就是将这 $k$ 个集合中的元素全部相乘，那么就有：

$$\begin{align\*}
p^{\alpha}=(p^1)^{d_1}(p^2)^{d_2}\cdot\cdot\cdot(p^k)^{d_k}\\
\therefore \alpha=1\cdot d_1+2\cdot d_2+\cdot\cdot\cdot+k\cdot d_k\\
\therefore \alpha=1\cdot(\[\frac{n}{p^1}\]-\[\frac{n}{p^{2}}\])+2\cdot(\[\frac{n}{p^2}\]-\[\frac{n}{p^{3}}\])+\cdot\cdot\cdot+k\cdot(\[\frac{n}{p^k}\]-\[\frac{n}{p^{k+1}}\])\\
\therefore \alpha=\[\frac{n}{p^1}\]+\[\frac{n}{p^2}\]+\cdot\cdot\cdot+\[\frac{n}{p^k}\]\\
\end{align\*}$$

&emsp;&emsp;命题得证。

&emsp;&emsp;**推论**：设 $n$ 是正整数，我们有(这里连乘号表示对所有不超过 $n$ 的素数求积)：

$$\begin{align\*}
n!=\prod_{p\leqslant n}p^{\alpha(p,n)}
\end{align\*}$$

&emsp;&emsp;**例**：求 $80!$ 的十进制表示中结尾部分零的个数。

&emsp;&emsp;**解**：如果考虑八十个数的连乘，那么会导致结尾部分有零的数会有很多，包括10的倍数，2的倍数与5的倍数的组合等等，但是如果我们考虑 $80!$ 标准素因数分解，那么贡献0的只有2和5，显然，2的幂次显然要大于5的幂次，所以最后的关键就是5的幂次，也就是求 $\alpha(5,80)$ ，代入公式即可。

&emsp;&emsp;**例**：设整数 $a_j>0$ ， $1\leqslant j\leqslant s$ ， $n=a_1+a_2+...+a_s$ ，证明： $n!/(a_1!a_2!...a_s!)$ 是整数。

&emsp;&emsp;**解**：我们依然考虑这些数的标准素因数分解，对于任意一个小于 $n$ 的素数 $p$ ，只要其在 $n!$ 的标准素因数分解式的幂次大于其在 $a_1!a_2!...a_s!$ 的标准素因数分解式的幂次，那么最后的结果就是整数。也就是说，我们只需证：对于任意一个小于 $n$ 的素数 $p$ ，必有

$$\begin{align\*}
\alpha(p,n)\geqslant\alpha(p,a_1)+\alpha(p,a_2)+...+\alpha(p,a_s)
\end{align\*}$$

&emsp;&emsp;也就是对于任意的 $i\geqslant 1$ ，都有

$$\begin{align\*}
\[\frac{n}{p^i}\]\geqslant\[\frac{a_1}{p^i}\]+\[\frac{a_2}{p^i}\]+...+\[\frac{a_s}{p^i}\]
\end{align\*}$$

&emsp;&emsp;由 $n=a_1+a_2+...+a_s$ 以及数论函数的性质(4)即可说明上式成立，命题得证。















